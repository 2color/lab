#!/usr/bin/env node

if (process.env.ROOT_SPAWN) {
    require('../test_runner/cli').run();
}
else {
    var Cpr = require('cpr');
    var Rimraf = require('rimraf');

    Cpr('./lib', './test_runner', { deleteFirst: true }, function (err) {

        if (err) {
            throw err;
        }

        process.env.ROOT_SPAWN = true;
        require('../test_runner/cli').run();
    });

    process.on('exit', function (code) {

        Rimraf.sync('./test_runner');
    });
}
